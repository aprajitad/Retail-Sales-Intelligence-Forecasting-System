<?xml version="1.0" encoding="UTF-8"?><sqlb_project><db path="C:/Users/aishwarya/Desktop/Retail_Sales_AI_Project/data/sales_project.db" readonly="0" foreign_keys="1" case_sensitive_like="0" temp_store="0" wal_autocheckpoint="1000" synchronous="2"/><attached/><window><main_tabs open="structure browser pragmas query" current="3"/></window><tab_structure><column_width id="0" width="300"/><column_width id="1" width="0"/><column_width id="2" width="100"/><column_width id="3" width="3485"/><column_width id="4" width="0"/><expanded_item id="0" parent="1"/><expanded_item id="1" parent="1"/><expanded_item id="2" parent="1"/><expanded_item id="3" parent="1"/></tab_structure><tab_browse><table title="retail_sales" custom_title="0" dock_id="1" table="4,12:mainretail_sales"/><dock_state state="000000ff00000000fd00000001000000020000024900000213fc0100000001fb000000160064006f0063006b00420072006f00770073006500310100000000000002490000012d00ffffff000002490000000000000004000000040000000800000008fc00000000"/><default_encoding codec=""/><browse_table_settings><table schema="main" name="retail_sales" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="97"/><column index="2" value="122"/><column index="3" value="73"/><column index="4" value="124"/><column index="5" value="62"/><column index="6" value="124"/><column index="7" value="85"/><column index="8" value="52"/><column index="9" value="71"/><column index="10" value="59"/><column index="11" value="132"/><column index="12" value="40"/><column index="13" value="94"/><column index="14" value="273"/><column index="15" value="140"/><column index="16" value="300"/><column index="17" value="95"/><column index="18" value="117"/><column index="19" value="109"/><column index="20" value="83"/><column index="21" value="93"/><column index="22" value="74"/><column index="23" value="121"/><column index="24" value="127"/><column index="25" value="63"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table></browse_table_settings></tab_browse><tab_sql><sql name="SQL 1*">-- 1. View sample data
SELECT * FROM retail_sales LIMIT 10;

-- 2. Row count
SELECT COUNT(*) AS total_rows FROM retail_sales;

-- 3. NULL check
SELECT
    SUM(CASE WHEN SALES IS NULL THEN 1 ELSE 0 END) AS null_sales,
    SUM(CASE WHEN ORDERDATE IS NULL THEN 1 ELSE 0 END) AS null_dates,
    SUM(CASE WHEN QUANTITYORDERED IS NULL THEN 1 ELSE 0 END) AS null_quantity
FROM retail_sales;

-- 4. Fix missing values
UPDATE retail_sales
SET QUANTITYORDERED = 0
WHERE QUANTITYORDERED IS NULL;

UPDATE retail_sales
SET PRICEEACH = 0
WHERE PRICEEACH IS NULL;

UPDATE retail_sales
SET SALES = QUANTITYORDERED * PRICEEACH
WHERE SALES IS NULL;

-- 5. Remove duplicates (SQLite-safe)
DELETE FROM retail_sales
WHERE rowid NOT IN (
    SELECT MIN(rowid)
    FROM retail_sales
    GROUP BY ORDERNUMBER, PRODUCTCODE, ORDERLINENUMBER
);

-- 6. Fix date format BEFORE aggregation
UPDATE retail_sales
SET ORDERDATE =
    substr(ORDERDATE, 7, 4) || '-' ||
    substr(ORDERDATE, 1, 2) || '-' ||
    substr(ORDERDATE, 4, 2)
WHERE ORDERDATE LIKE '%/%';

-- 7. Verify date range
SELECT
    MIN(ORDERDATE) AS min_date,
    MAX(ORDERDATE) AS max_date
FROM retail_sales;

-- 8. Monthly Revenue (Forecast input)
SELECT
    strftime('%Y-%m', ORDERDATE) AS Month,
    SUM(SALES) AS MonthlyRevenue
FROM retail_sales
GROUP BY Month
ORDER BY Month;

-- 9. Moving Average
SELECT
    Month,
    MonthlyRevenue,
    AVG(MonthlyRevenue) OVER (
        ORDER BY Month
        ROWS BETWEEN 2 PRECEDING AND CURRENT ROW
    ) AS MovingAvg_3Months
FROM (
    SELECT
        strftime('%Y-%m', ORDERDATE) AS Month,
        SUM(SALES) AS MonthlyRevenue
    FROM retail_sales
    GROUP BY Month
);

-- 10. Forecast-ready table
DROP TABLE IF EXISTS monthly_sales;

CREATE TABLE monthly_sales AS
SELECT
    strftime('%Y-%m', ORDERDATE) AS Month,
    SUM(SALES) AS MonthlyRevenue
FROM retail_sales
GROUP BY Month
ORDER BY Month;

SELECT * FROM monthly_sales;
</sql><current_tab id="0"/></tab_sql></sqlb_project>
